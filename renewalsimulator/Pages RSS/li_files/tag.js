(function(a){"use strict";const c=new URLSearchParams(a.location.search).has('zbo_debug'),d=parseInt(new URLSearchParams(a.location.search).get('zbo_debug'))||0;var b={tags:[{id:158,type:"Custom_Image",values:[{code:"https://secure.adnxs.com/px?id=1466633&t=2",async:!1,withSrc:!1}],triggerIds:[164,165],triggerExceptionIds:[],onlyOnce:!0,shouldSkip:!1}],executedTagIDs:[],vars:{74:{name:"URL_Path",type:"URL_Path",value:a.location.pathname+a.parent.location.hash.substr(0,a.parent.location.hash.indexOf("?")>=0?a.parent.location.hash.indexOf("?"):a.parent.location.hash.length)}},triggers:{164:{type:"Window_Loaded",value:"",conditions:[{variableId:74,operator:"contains",compareTo:"auto/magazine/formule-e/"}]},165:{type:"Window_Loaded",value:"",conditions:[{variableId:74,operator:"contains",compareTo:"automobile/dossier/formula-e"}]}},_events:[],is_debug:c,debug_value:d,interId:null,init:function(){let b=!0;for(let c in a._zbo)if(c!="register")if(b=!1,this._events[c]=this._events[c]||[],typeof a._zbo[c]=='object')for(let b of a._zbo[c])this._events[c].push(b||{});else this._events[c].push(a._zbo[c]||{});b&&this.register("afterAll")},exec:function(){var c,b,a;clearInterval(this.interId),this._events.length&&this.debug(0,"Executing events...");for(let d in this._events){c=this._events[d].length;for(let f=0;f<c;f++){let e=this._events[d][f]||{};this.debug(0,"> Current event type",d,"with datalayer",e);for(let h in this.tags){let c=this.tags[h];if(c.shouldSkip||c.dependsOn!=void 0&&this.executedTagIDs.indexOf(c.dependsOn)==-1){this.debug(1,"-> Skipping tag",c.id,"as it has already been executed once");continue}let g=!0,f=-1;if(this.debug(1,"-> Processing event for tag",c.id),this.debug(1,"--> Checking Triggers..."),c.triggerIds!=void 0)for(let h of c.triggerIds)[b,a]=this._checkTrigger(h,d,e,!0),b&&(g=!1,f=a!=null&&f==-1||a<f?a:f);if(g){this.debug(1,">> Triggers didn't match. Skipping tag! <<");continue}if(this.debug(1,"--> Checking ExceptionTriggers..."),c.triggerExceptionIds!=void 0)for(let f of c.triggerExceptionIds)if([b,a]=this._checkTrigger(f,d,e,!1),!b){g=!0;break}if(g){this.debug(1,">> ExceptionTriggers match. Skipping tag! <<");continue}this.debug(1,"--> Preparing execution of tag",c.id),this.execTags(d,c,f,e),this.executedTagIDs.indexOf(c.id)==-1&&this.executedTagIDs.push(c.id),c.onlyOnce&&!c.shouldSkip&&(c.shouldSkip=!0)}}delete this._events[d]}this.interId=setInterval(this.exec.bind(this),500)},execTags:function(d,a,b,e){let c=[];for(let b of a.values)c.push({code:this._render(d,b.code,e),async:b.async,src:b.withSrc});if(this.debug(1,"---> Tag values are:",c),b!=null&&b!=0)return this.debug(1,"---> Tag",a.id,"will be executed with a delay of",b),this.timers(a.type,c,b);this.debug(1,"---> Executing tag",a.id),this.appendNodes(a.type,c)},timers:function(a,b,c){for(let d in b)setTimeout(this.appendNode.bind(this,a,d.code,d.async),c)},appendNode:function(c,b,d,e){var a;switch(this.debug(1,"Appending node of type",c+"(async:"+d+", src:"+e+"):\n",b),c){case'Custom_HTML':a=document.createElement('script'),d&&a.setAttribute('async',''),e?a.setAttribute('src',b):a.append(b),document.body.append(a);break;case'Custom_Image':a=document.createElement('img'),a.style.display='none',a.src=b,document.body.append(a);break;default:console.error('[ZBO-Reactor] Unknown trigger kind',c)}},appendNodes:function(a,b){for(let c of b)this.appendNode(a,c.code,c.async,c.src)},register:function(a,b){this.debug(0,"Registering event",a,"with datalayer",b||{}),this._events[a]=this._events[a]||[],this._events[a].push(b||{})},_render:function(b,a,c){for(let e in this.vars){let f=this.vars[e].name,d=this.vars[e].value;switch(this.vars[e].type){case'Data_Layer_Variable':d=c[this.vars[e].value];break;case'Event':d=b;break;case'Random':d=d();break;default:d=this.vars[e].value;break}a=a.replace(new RegExp('{{\\s*'+f+'\\s*}}','g'),d)}return a},_checkTrigger:function(c,d,e,a){let b=this.triggers[c];if(b==void 0)return[!1,null];this.debug(1,"Checking trigger",b);for(let c of b.conditions){let g=this.vars[c.variableId],f;switch(g.type){case'Event':if(f=this._op(c.operator,d,c.compareTo),this.debug(1,"> Condition["+g.type+"] ("+d,c.operator,c.compareTo+") returned",f,"expected",a),f!=a)return[!1,null];break;case'Data_Layer_Variable':if(f=this._op(c.operator,e[g.value],c.compareTo),this.debug(1,"> Condition["+g.type+"] ("+e[g.value],c.operator,c.compareTo+") returned",f,"expected",a),f!=a)return[!1,null];break;case'Custom_JavaScript':case'Constant':case'URL':case'HTTP_Referrer':case'URL_Path':case'URL_Path_full':if(f=this._op(c.operator,g.value,c.compareTo),this.debug(1,"> Condition["+g.type+"] ("+g.value,c.operator,c.compareTo+") returned",f,"expected",a),f!=a)return[!1,null];break;case'Random':if(f=this._op(c.operator,g.value(),c.compareTo),f!=a)return[!1,null];break}}return this.debug(1,"Trigger "+c+" is valid"),[!0,b.value?Number(b.value):0]},_op:(c,a,b)=>{switch((a!==Number||b!==Number)&&(a=String(a),b=String(b)),c){case'=':return a==b;case'!=':return a!=b;case'isDefined':return a!=void 0;case'contains':return a.indexOf(b)!=-1;case'startsWith':return a.startsWith(b);case'endsWith':return a.endsWith(b)}return!1},debug:function(a,...b){this.is_debug&&a<=this.debug_value&&console.debug("[zbo]",...b)}};if(!a._zbo||!a._zbo.init)try{b.init(),a._zbo=b,setTimeout(b.exec.bind(b),100)}catch(a){}})(this)