(function(){if(typeof window.__tcfapi=="function")return;if(typeof window.__cmp=="function")return;var e=function(e){var t=window,n=null;while(!n){try{t.frames[e]&&(n=t)}catch(r){}if(t===window.top)break;t=t.parent}return n},t,n,r={};if(t=e("__tcfapiLocator"))n="__tcfapiReturn",window.__tcfapi=function(e,n,i,s){var o=Math.random()+"",u={__tcfapiCall:{command:e,parameter:s,version:n,callId:o}};r[o]=i,t.postMessage(u,"*")};else{if(!(t=e("__cmpLocator")))return;n="__cmpReturn",window.__cmp=function(e,n,i){var s=Math.random()+"",o={__cmpCall:{command:e,parameter:n,callId:s}};r[s]=i,t.postMessage(o,"*")}}var i=function(e){var t={};try{t=typeof e.data=="string"?JSON.parse(e.data):e.data}catch(i){}var s=t[n];s&&typeof r[s.callId]=="function"&&(r[s.callId](s.returnValue,s.success),delete r[s.callId])};window.addEventListener("message",i,!1)})();var Utils={version:2021090101,isCookieSet:function(e){return document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)")},areCookiesEnabled:function(){var e=navigator.cookieEnabled?!0:!1,t=navigator.userAgent.toLowerCase(),n=t.indexOf("msie")!==-1||t.indexOf("trident")!==-1;if(navigator.cookieEnabled===undefined||n)document.cookie="__wtestcookie",e=document.cookie.indexOf("__wtestcookie")!==-1?!0:!1;return e},getCookieName:function(){var e=Config.cookieName;if(e)return e;var t=this.getDataSyncKey();return e=Config.cookiePrefix||"_xttrk2",t&&(e+="_"+t),e},run:function(e){if(!this.areCookiesEnabled()){this.log("skip sync, cookies are not enable on this browser");return}var t=this.getCookieName();if(this.isCookieSet(t)){this.log("skip sync, already sync / blocked by cookie",t);return}var n=document.URL.indexOf("loop=1")!=-1,r=typeof Config.useDataSync!="undefined"?Config.useDataSync:!0,i=Config.dataSyncCapping||0,s=new Date;!r&&i>0&&(r=s.getMilliseconds()%100<i),n&&(r=!1),this.log("call extractGDPRParameters");var o=this;this.extractGDPRParameters(function(t){r?o.waitCookieAndCallDataSync(e,s,t):o.waitCookieAndCallTrackers(e,s,t)})},extractGDPRParameters:function(e){var t=this.__extractGDPRParametersFromLocation(document.location);if(t!=null){this.log("gdpr params extract from query string",t),e(this.__buildURLDecoratorWithGDPR(t));return}if(typeof window.__tcfapi=="function"){this.log("use tcf v2 new api"),this.__extractGDPRParametersFromTCFv2(e);return}if(typeof window.__cmp=="function"){this.log("use tcf v1 old api"),this.__extractGDPRParametersFromTCFv1(e);return}this.log("fallback: call callback with a nop decorator"),e(function(e){return e})},waitCookieAndCallDataSync:function(e,t,n){this.log("using data-sync service via waitCookieAndCallDataSync");var r=this.isUserIDSet();if(r===!1){this.log("skip sync, pseudo or optout cookie");return}if(r===!0){this.log("user exists, callDataSync"),this.callDataSync(t,n);return}this.log("wait for weborama id"),e-=1;if(e>0&&r===null){var i=this;window.setTimeout(function(){i.waitCookieAndCallDataSync(e,t,n)},500);return}this.log("no more wait for weborama id, call service as fallback"),this.callDataSync(t,n)},getDataSyncKey:function(){if(Config.dataSyncKey)return Config.dataSyncKey;var e=this.__extractQueryArgsFromLocation(document.location),t=e?e.key||"":"";return encodeURIComponent(t)},callDataSync:function(e,t){var n=Config.dataSyncHost||"ds.frontend.weborama.fr",r=this.__extractQueryArgsFromLocation(document.location),i=this.__extractSourceFromLocation(document.location),s=this.getDataSyncKey(),o="https://"+n+"/sync?",u=[];s&&u.push("key="+encodeURIComponent(s)),i&&u.push("src="+encodeURIComponent(i)),r.wamid!==undefined&&r.wamid!==null&&u.push("wamid="+encodeURIComponent(r.wamid)),u.push("callback=Utils.handleDataSync"),u.push("v="+encodeURIComponent(this.version)),o+=u.join("&");var a=document.createElement("script");a.type="text/javascript",a.src=t(o);var f=document.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f),this.log("calling data-sync",a.src)},handleDataSync:function(e){var t=this;this.extractGDPRParameters(function(n){t.log("receive data from data-sync",e),t.__fireTrackers(e,new Date,n)})},waitCookieAndCallTrackers:function(e,t,n){this.log("calling trackers (legacy) via waitCookieAndCallTrackers");var r=document.URL,i=document.URL.indexOf("loop=1")!=-1,s=this.isUserIDSet();if(s===!1){this.log("skip sync, pseudo or optout cookie");return}if(i&&s===!0){this.log("after loop and user exists, callTrackers"),this.callTrackers(t,n);return}this.log("wait for weborama id"),e-=1;if(e>0&&s===null){var o=this;window.setTimeout(function(){o.waitCookieAndCallTrackers(e,t,n)},500);return}this.log("no more wait for weborama id, loop over redirect as fallback");if(!i){var u=r.indexOf("?")==-1?"?":"&",a=r.replace(/^http:/,"https:")+u+"loop=1",f="https://rd.frontend.weborama.fr/rd?key=synchro&url="+encodeURIComponent(a);window.location.replace(n(f));return}this.log("skip synchro, failed to set a cookie, even with redirect ...")},callTrackers:function(e,t){if(typeof Config["trackersSSL"]!="object")return;var n=Config.trackersSSL,r=this.__extractQueryArgsFromLocation(document.location);if(r.wamid!==undefined&&r.wamid!==null){var i=r.wamid;Config.specificTrackersSSL[i]!==undefined&&Config.specificTrackersSSL[i]!==null&&(this.log("fire specific trackers for wamid",i),n=Config.specificTrackersSSL[i])}this.__fireTrackers(n,e,t)},__buildURLDecoratorWithGDPR:function(e){return function(t){return e!=null&&t.indexOf("gdpr=")==-1&&(t+=t.indexOf("?")==-1?"?":"&",t+=e.join("&")),t}},__extractGDPRParametersFromLocation:function(e){var t=null,n=this.__extractQueryArgsFromLocation(e);for(var r in n)if(r.indexOf("gdpr")==0){t==null&&(t=[]);var i=r+"="+n[r];t.push(i)}return t},__extractGDPRParametersFromTCFv1:function(e){var t=this;window.__cmp("getConsentData",null,function(n,r){var i=["gdpr=0"];r?n.gdprApplies&&(i=["gdpr=1","gdpr_consent="+(n.consentData||"")]):i=["gdpr=1","gdpr_cmp_failure=1"],e(t.__buildURLDecoratorWithGDPR(i))})},__extractGDPRParametersFromTCFv2:function(e){var t=this;window.__tcfapi("getTCData",2,function(n,r){var i=null;if(!r)i=["gdpr=1","gdpr_cmp_failure=1"];else if(!n.gdprApplies)i=["gdpr=0"];else{if(n.eventStatus=="cmpuishown"||n.eventStatus=="tcloaded"&&!n.purpose.consents[1]){window.__tcfapi("addEventListener",2,function(n,r){if(r&&n!=null&&n.eventStatus=="useractioncomplete"){window.__tcfapi("removeEventListener",2,function(){},n.listenerId);var i=["gdpr=1","gdpr_consent="+(n.tcString||"")];e(t.__buildURLDecoratorWithGDPR(i))}});return}i=["gdpr=1","gdpr_consent="+(n.tcString||"")]}e(t.__buildURLDecoratorWithGDPR(i))})},__fireTrackers:function(e,t,n){var r=Config.cookieLifetime||7,i=t.getYear()<2e3?t.getYear()+1900:t.getYear(),s=(new Date(i,t.getMonth(),t.getDate()+r)).toGMTString(),o,u;for(u in Config.cookies)this.log("set cookie",Config.cookies[u],"expires=",s),document.cookie=Config.cookies[u]+"=1; expires="+s+"; path=/; SameSite=None; Secure";if(e.PIXEL!==undefined&&e.PIXEL!==null)for(o=0;o<e.PIXEL.length;o++){var a=e.PIXEL[o];this.writeTrackerPIXEL(n(a))}if(e.IFRAME!==undefined&&e.IFRAME!==null)for(o=0;o<e.IFRAME.length;o++){var a=e.IFRAME[o];this.writeTrackerIFRAME(n(a))}if(e.JAVASCRIPT!==undefined&&e.JAVASCRIPT!==null)for(o=0;o<e.JAVASCRIPT.length;o++){var a=e.JAVASCRIPT[o];this.writeTrackerJAVASCRIPT(n(a))}if(e.COOKIE!==undefined&&e.COOKIE!==null)for(o=0;o<e.COOKIE.length;o++){var f=e.COOKIE[o];this.writeCookie(f,s)}},writeCookie:function(e,t){document.cookie=e+"=1; expires="+t+"; path=/; SameSite=None; Secure",this.log("write cookie",e,"=1","expires",t)},writeTrackerPIXEL:function(e){var t=new Image(1,1);t.src=e,t.onload=function(){return 1},this.log("write pixel",e)},writeTrackerIFRAME:function(e){var t=document.createElement("iframe");t.setAttribute("width",1),t.setAttribute("height",1),t.setAttribute("frameborder",0),t.setAttribute("style","border:0px"),t.setAttribute("src",e);try{document.body.appendChild(t)}catch(n){this.log("error while add iframe",n)}this.log("write iframe",e)},writeTrackerJAVASCRIPT:function(e){e.indexOf("%%User_ID%%")>=0&&(userID=document.cookie.match("AFFICHE_W=([^!_][^;]*)(;|$)"),e=e.replace("%%User_ID%%",userID[1]));var t=document.createElement("script");t.type="text/javascript",t.src=e;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),this.log("write script",e)},isUserIDSet:function(){var e,t;return e=document.cookie.match("AFFICHE_W=([^;]*)(;|$)"),e===null?null:(t=e[1].substr(0,1),t==="!"||t==="_"?!1:!0)},__extractSourceFromLocation:function(e){var t=e.pathname,n=t.split("/");return n[n.length-1]},__extractQueryArgsFromLocation:function(e){var t=e.search,n={},r=t.indexOf("?");if(r===-1)return n;var i=t.substring(r+1).split("&");for(var s in i){var o=i[s].split("=");n[o[0]]=o[1]}return n},log:function(){Config.debug&&console.log.apply(console,this.prepend("[weborama external_libs]",arguments))},prepend:function(e,t){var n=Array.prototype.slice.call(t);return n.unshift(e),n}};