!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){(function(t,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var o;o=function(){"use strict";function e(e){return"function"==typeof e}var o=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,r=void 0,a=void 0,s=function(e,t){m[i]=e,m[i+1]=t,2===(i+=2)&&(a?a(h):_())},c="undefined"!=typeof window?window:void 0,u=c||{},l=u.MutationObserver||u.WebKitMutationObserver,p="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),d="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(h,1)}}var m=new Array(1e3);function h(){for(var e=0;e<i;e+=2)(0,m[e])(m[e+1]),m[e]=void 0,m[e+1]=void 0;i=0}var y,g,v,b,_=void 0;function w(e,t){var n=this,o=new this.constructor(A);void 0===o[C]&&E(o);var i=n._state;if(i){var r=arguments[i-1];s((function(){return M(i,o,r,n._result)}))}else O(n,o,e,t);return o}function k(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(A);return P(t,e),t}p?_=function(){return t.nextTick(h)}:l?(g=0,v=new l(h),b=document.createTextNode(""),v.observe(b,{characterData:!0}),_=function(){b.data=g=++g%2}):d?((y=new MessageChannel).port1.onmessage=h,_=function(){return y.port2.postMessage(0)}):_=void 0===c?function(){try{var e=Function("return this")().require("vertx");return void 0!==(r=e.runOnLoop||e.runOnContext)?function(){r(h)}:f()}catch(e){return f()}}():f();var C=Math.random().toString(36).substring(2);function A(){}function x(t,n,o){n.constructor===t.constructor&&o===w&&n.constructor.resolve===k?function(e,t){1===t._state?T(e,t._result):2===t._state?S(e,t._result):O(t,void 0,(function(t){return P(e,t)}),(function(t){return S(e,t)}))}(t,n):void 0===o?T(t,n):e(o)?function(e,t,n){s((function(e){var o=!1,i=function(e,t,n,o){try{e.call(t,n,o)}catch(e){return e}}(n,t,(function(n){o||(o=!0,t!==n?P(e,n):T(e,n))}),(function(t){o||(o=!0,S(e,t))}),e._label);!o&&i&&(o=!0,S(e,i))}),e)}(t,n,o):T(t,n)}function P(e,t){if(e===t)S(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(o=t),null===o||"object"!==i&&"function"!==i)T(e,t);else{var n=void 0;try{n=t.then}catch(t){return void S(e,t)}x(e,t,n)}var o,i}function I(e){e._onerror&&e._onerror(e._result),D(e)}function T(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&s(D,e))}function S(e,t){void 0===e._state&&(e._state=2,e._result=t,s(I,e))}function O(e,t,n,o){var i=e._subscribers,r=i.length;e._onerror=null,i[r]=t,i[r+1]=n,i[r+2]=o,0===r&&e._state&&s(D,e)}function D(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var o=void 0,i=void 0,r=e._result,a=0;a<t.length;a+=3)o=t[a],i=t[a+n],o?M(n,o,i,r):i(r);e._subscribers.length=0}}function M(t,n,o,i){var r=e(o),a=void 0,s=void 0,c=!0;if(r){try{a=o(i)}catch(e){c=!1,s=e}if(n===a)return void S(n,new TypeError("A promises callback cannot return that same promise."))}else a=i;void 0!==n._state||(r&&c?P(n,a):!1===c?S(n,s):1===t?T(n,a):2===t&&S(n,a))}var j=0;function E(e){e[C]=j++,e._state=void 0,e._result=void 0,e._subscribers=[]}var q=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(A),this.promise[C]||E(this.promise),o(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&T(this.promise,this._result))):S(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,o=n.resolve;if(o===k){var i=void 0,r=void 0,a=!1;try{i=e.then}catch(e){a=!0,r=e}if(i===w&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(n===R){var s=new n(A);a?S(s,r):x(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new n((function(t){return t(e)})),t)}else this._willSettleAt(o(e),t)},e.prototype._settledAt=function(e,t,n){var o=this.promise;void 0===o._state&&(this._remaining--,2===e?S(o,n):this._result[t]=n),0===this._remaining&&T(o,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;O(e,void 0,(function(e){return n._settledAt(1,t,e)}),(function(e){return n._settledAt(2,t,e)}))},e}(),R=function(){function t(e){this[C]=j++,this._result=this._state=void 0,this._subscribers=[],A!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){P(e,t)}),(function(t){S(e,t)}))}catch(t){S(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var n=this.constructor;return e(t)?this.then((function(e){return n.resolve(t()).then((function(){return e}))}),(function(e){return n.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return R.prototype.then=w,R.all=function(e){return new q(this,e).promise},R.race=function(e){var t=this;return o(e)?new t((function(n,o){for(var i=e.length,r=0;r<i;r++)t.resolve(e[r]).then(n,o)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},R.resolve=k,R.reject=function(e){var t=new this(A);return S(t,e),t},R._setScheduler=function(e){a=e},R._setAsap=function(e){s=e},R._asap=s,R.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var o=null;try{o=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===o&&!t.cast)return}e.Promise=R},R.Promise=R,R},e.exports=o()}).call(this,n(2),n(3))},function(e,t,n){n(0),e.exports=n(4)},function(e,t){var n,o,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var c,u=[],l=!1,p=-1;function d(){l&&c&&(l=!1,c.length?u=c.concat(u):p=-1,u.length&&f())}function f(){if(!l){var e=s(d);l=!0;for(var t=u.length;t;){for(c=u,u=[];++p<t;)c&&c[p].run();p=-1,t=u.length}c=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new m(e,t)),1!==u.length||l||s(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(5);"undefined"==typeof Promise&&o.polyfill();var r=window;if(/googlebot|adsbot-google|mediapartners-google|bingbot|bingpreview|msnbot|facebot|facebookexternalhit|aolbuild|baiduspider|duckduckbot|teoma|slurp|yandexbot|ia_archiver|mj12bot/i.test(window.navigator.userAgent));else if("function"!=typeof r.mediego){var a=new i.Agent([]);r.mediego=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a.executeCommand(e)},r.mediego.initialized=!0,a.compatibilityMode()}else if(!r.mediego.initialized){var s=r.mediego.q||[],c=new i.Agent(s);r.mediego=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];c.executeCommand(e)},r.mediego.initialized=!0}},function(e,t,n){"use strict";var o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,i++)o[i]=r[a];return o};Object.defineProperty(t,"__esModule",{value:!0}),t.Agent=void 0;var i=n(6),r=n(7),a=n(8),s=n(11),c=n(12),u=function(){function e(e){this.initialized=!0,this.api=new i.API,this.tracking=new r.Tracking(this.api),this.segmentation=new a.Segmentation(this.api),this.display=new s.DisplayAPI(this.api),this.consent=!0,this.engineId=null,this.externalUserID=null,this.lastTrackingResponse=null,this.commandQueue=[];for(var t=0,n=e;t<n.length;t++){var o=n[t];this.executeCommand(o)}}return e.prototype.executeCommand=function(e){var t,n=e[0],o=Array.prototype.slice.call(e,1);(t=this)[n].apply(t,o)},e.prototype.enqueueCommand=function(e,t){var n=Array.prototype.slice.call(t),i=o([e],n);this.commandQueue.push(i)},e.prototype.resumeCommands=function(){var e=o(this.commandQueue);this.commandQueue=[];for(var t=0,n=e;t<n.length;t++){var i=n[t];this.executeCommand(i)}},e.prototype.test=function(e){console.log("Mediego agent received test command with the following message: "+e)},e.prototype.compatibilityMode=function(){var e=this,t=window;t.mediego.execute=function(t){e.trackVisit()},t.mediego_domain&&this.setAPIDomain(t.mediego_domain),t.mediego_cookie_domain&&this.setCookieDomain(t.mediego_cookie_domain);var n=t.mediego_euid||c.AgentUtils.getCookie("mediego_euid")||null;null!=n&&"function"==typeof n&&(n=n()),this.setExternalUserId(n),this.addRecommendationCallback(this.philibertCallback),this.trackVisit(),this.waitAndDisplayRecommendations()},e.prototype.setAPIDomain=function(e){this.api.domain=e},e.prototype.setCookieDomain=function(e){this.api.cookieDomain=e},e.prototype.setExternalUserId=function(e){this.externalUserID=e},e.prototype.setEngine=function(e){this.engineId=e},e.prototype.trackVisit=function(){var e=this;this.checkConsent("trackVisit",arguments,(function(){e.tracking.trackVisit(e.engineId,e.externalUserID).then((function(t){var n=t[0],o=t[1];return e.lastTrackingResponse=o,o.requires_segmentation&&e.segmentation.main(n,o),e.resumeCommands(),t}))}))},e.prototype.displayRecommendations=function(){var e=this,t=arguments;this.checkConsent("displayRecommendations",t,(function(){e.lastTrackingResponse?e.display.main(e.lastTrackingResponse.muid,e.externalUserID):e.enqueueCommand("displayRecommendations",t)}))},e.prototype.waitAndDisplayRecommendations=function(){var e=this,t=!1;"interactive"===document.readyState||"complete"===document.readyState?(t=!0,this.displayRecommendations()):document.onreadystatechange=function(){t||"interactive"!==document.readyState&&"complete"!==document.readyState||(t=!0,e.displayRecommendations())}},e.prototype.waitForConsent=function(){this.consent=!1},e.prototype.acceptConsent=function(){this.consent=!0,this.resumeCommands()},e.prototype.denyConsent=function(){this.consent=!1,this.commandQueue=[]},e.prototype.checkConsent=function(e,t,n){if(this.consent)return n();this.enqueueCommand(e,t)},e.prototype.addRecommendationCallback=function(e){this.display.addCallback(e)},e.prototype.philibertCallback=function(e){if([13222,13223,13226,13229].indexOf(e.engine)>=0){for(var t=[],n=0;n<e.recommendations.length;n++){var o=e.recommendations[n];t.push({id:o.metadata["product:id"],ruuid:o.id})}$.ajax({type:"POST",url:"/modules/ukoomediego/ajax.php?task=ajax_process_load_mediego_suggests",data:{display:$("#ukoomediego_block_products").data("display"),products_ruuid:t},dataType:"text",error:function(e,t,n){window.mediegoCallbackError(e,t,n)},success:function(e){window.mediegoCallbackSuccess(e)}})}},e}();t.Agent=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.API=void 0;var o=function(){function e(t,n){void 0===t&&(t=e.defaultDomain),void 0===n&&(n=e.defaultDomain),this.domain=t||e.defaultDomain,this.cookieDomain=n||this.domain,this.endpoint="https://"+this.domain}return e.prototype.get=function(t,n){var o=this;return new Promise((function(i,r){o.cookieDomain!==e.defaultDomain&&(n.domain=o.cookieDomain);var a="";Object.keys(n).length>0&&(a="?"+Object.keys(n).map((function(e){return e+"="+encodeURIComponent(n[e])})).join("&"));var s=o.endpoint+t+a,c=new XMLHttpRequest;c.open("GET",s,!0),c.withCredentials=!0,c.onload=function(){c.status>=200&&c.status<300?i(JSON.parse(c.response)):r(c.statusText)},c.onerror=function(){return r(c.statusText)},c.send(null)}))},e.prototype.post=function(t,n){var o=this;return new Promise((function(i,r){o.cookieDomain!==e.defaultDomain&&(n.domain=o.cookieDomain);var a=o.endpoint+t,s=new XMLHttpRequest;s.open("POST",a,!0),s.withCredentials=!0,s.onload=function(){s.status>=200&&s.status<300?i(JSON.parse(s.response)):r(s.statusText)},s.onerror=function(){return r(s.statusText)},s.send(JSON.stringify(n))}))},e.defaultDomain="api.mediego.com",e}();t.API=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tracking=void 0;var o=function(){function e(e){this.api=e}return e.prototype.trackVisit=function(t,n){var o={};t&&(o.engine=t);try{var i=localStorage.getItem(e.localStorageMuidKey);i&&(o.muid=i)}catch(e){}n&&(o.euid=n),o.referrer=document.URL,document.referrer&&document.referrer.length>0&&(o.origin=document.referrer);var r=this.api.get("/1.0/track/visit",o);return r.then((function(t){try{localStorage.setItem(e.localStorageMuidKey,t.muid)}catch(e){}})),r.then((function(e){return[o,e]}))},e.localStorageMuidKey="mediego:uid",e}();t.Tracking=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Segmentation=void 0;var o=n(9),i=function(){function e(e){this.api=e}return e.prototype.main=function(t,n){var i={};i.muid=n.muid,null!=i.euid&&(i.euid=t.euid),i.timestamp=n.timestamp,i.referrer=t.referrer,i.executedActions="[]";try{var r=localStorage.getItem(e.localStorageKey);null!==r&&(i.executedActions=r)}catch(e){}var a=this.api.post("/2.0/users/"+n.muid+"/segments",i);return a.then((function(t){for(var n=0,i=t.actions;n<i.length;n++){var r=i[n],a=r.parameters;switch(r.type){case"popup-action":new o.Popup(a.template,a.position,a.animation,a.delay_ms,r.actionId,r.displayId).display()}}try{localStorage.setItem(e.localStorageKey,JSON.stringify(t.executedActions))}catch(e){}})),a},e.localStorageKey="mediego:executed_actions",e}();t.Segmentation=i},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Popup=void 0;var popupContainerHtml=__webpack_require__(10),Popup=function(){function e(e,t,n,o,i,r){var a=this;this.onCloseCallbacks=[],this.template=e,this.delay=o,this.actionId=i,this.displayId=r,this.popupContainer=document.createElement("div"),this.popupContainer.innerHTML=popupContainerHtml,this.popupCloseButton=this.popupContainer.querySelector(".mediego-popup-close"),this.popupCloseButton.onclick=function(e){a.close()},this.popupContent=this.popupContainer.querySelector(".mediego-popup-content"),this.popupContent.innerHTML=this.template;var s,c,u=this.popupContainer.querySelector(".mediego-popup");switch(u.setAttribute("actionid",this.actionId),u.setAttribute("displayid",this.displayId),t){case"TopCenter":s="mediego-popup-top-center";break;case"Center":s="mediego-popup-center";break;case"BottomRight":s="mediego-popup-bottom-right";break;case"BottomCenter":s="mediego-popup-bottom-center";break;default:s="mediego-popup-top-center"}switch(u.classList.add(s),n){case"FadeIn":c="mediego-fade-in";break;case"SlideTop":c="mediego-slide-top"}c&&u.classList.add(c)}return e.prototype.display=function(){var e=this;setTimeout((function(){document.body.appendChild(e.popupContainer);for(var t=e.popupContent.querySelectorAll("script"),n=0;n<t.length;n++){buildClientFunction(t.item(n).text,e)()}}),this.delay)},e.prototype.close=function(){document.body.contains(this.popupContainer)&&document.body.removeChild(this.popupContainer);for(var e=0,t=this.onCloseCallbacks;e<t.length;e++){(0,t[e])()}},e.prototype.onClose=function(e){this.onCloseCallbacks.push(e)},e}();function buildClientFunction(clientCode,concretePopup){return function(){var popup={onClose:function(e){concretePopup.onClose(e)},close:function(){concretePopup.close()},actionId:concretePopup.actionId,displayId:concretePopup.displayId};eval(clientCode)}}exports.Popup=Popup},function(e,t){e.exports="<style>.mediego-popup{display:block;z-index:1000;background-color:transparent;border-radius:5px}.mediego-popup-close-container{position:relative;float:right}.mediego-popup-close{background-color:transparent;border:none;font-size:large;font-weight:700;color:#000}.mediego-popup-content{padding:20px}.mediego-popup-center{position:fixed;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.mediego-popup-top-center{position:fixed;top:0;left:50%;-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);transform:translate(-50%,0)}.mediego-popup-bottom-right{position:fixed;bottom:0;right:0}.mediego-popup-bottom-center{position:fixed;bottom:0;left:50%;-webkit-transform:translate(-50%,0);-ms-transform:translate(-50%,0);transform:translate(-50%,0)}.mediego-fade-in{animation:fadeIn .5s}@keyframes fadeIn{from{opacity:0}to{opacity:1}}.mediego-slide-top{animation:slideTop .5s}@keyframes slideTop{from{margin-top:-100%}to{margin-top:0}}</style> <div class=mediego-popup> <div class=mediego-popup-close-container> <button class=mediego-popup-close>X</button> </div> <div class=mediego-popup-content> </div> </div>"},function(module,exports,__webpack_require__){"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},__generator=this&&this.__generator||function(e,t){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=t.call(e,a)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.DisplayAPI=void 0;var DisplayAPI=function(){function DisplayAPI(e){this.callbacks=[],this.api=e}return DisplayAPI.prototype.main=function(e,t){var n=this;this.hideMediegoContent();var o=this.parseMediegoNodes(),i=document.URL,r=[];o.forEach((function(o){n.containsRequest(r,o.engine,o.source)||r.push({muid:e,euid:t,engine:o.engine,source:o.source,referrer:i,format:"agent"})})),r.reduce((function(e,t){return __awaiter(n,void 0,void 0,(function(){var n,i,r,a,s;return __generator(this,(function(c){switch(c.label){case 0:return[4,e];case 1:if(n=c.sent(),i=[],n)for(r=0,a=n.items;r<a.length;r++)s=a[r],i.push.apply(i,s.itemExternalIds);return[4,this.request(__assign(__assign({},t),{blacklistedItems:i}),o)];case 2:return[2,c.sent()]}}))}))}),Promise.resolve(null))},DisplayAPI.prototype.insertContentInNode=function(node,display){var recommendation=display.items[node.recoIndex],content;if(recommendation&&("title"===node.metadata?content=recommendation.metadata.title:eval("content = recommendation."+node.metadata)),node.isOptional&&void 0===content)node.node.style.display="none";else if(node.isBoolean&&"false"===content)node.node.style.display="none";else if(!node.isBoolean&&void 0!==content)switch(node.node.nodeName){case"IMG":node.node.setAttribute("src",content);break;case"A":node.node.setAttribute("href",content);break;default:node.node.innerHTML=content}},DisplayAPI.prototype.request=function(e,t){var n=this;return this.api.post("/1.0/recommendations/json",e).then((function(o){if(o.variant.isMediego)t.forEach((function(t){t.engine===e.engine&&t.source===e.source&&n.insertContentInNode(t,o)})),n.showMediegoContent(o.engine,o.source);else var i=1,r=setInterval((function(){var e;((e=document.querySelectorAll(o.variant.query)).length>0&&(e.forEach((function(e){o.items[0].link;for(var t=e.getElementsByTagName("a"),n=0;n<t.length;n++){for(var i in t[n].href+=t[n].href.indexOf("?")<0?"?":"&",t[n].href+="mediego_ruuid="+o.id+"_0",o.tracking.parameters)t[n].href+="&"+i+"="+encodeURIComponent(o.tracking.parameters[i]);for(var i in o.tracking.rawParameters)t[n].href+="&"+i+"="+o.tracking.parameters[i]}e.style.display=""})),!0)||i>=20)&&clearInterval(r),i++}),50);for(var a={id:o.id,engine:o.engine,variant:o.variant.id,recommendations:o.items.map((function(e){return{id:e.id,metadata:e.metadata}}))},s=0,c=n.callbacks;s<c.length;s++){(0,c[s])(a)}return o}),(function(e){return null}))},DisplayAPI.prototype.addCallback=function(e){this.callbacks.push(e)},DisplayAPI.prototype.hideMediegoContent=function(){document.querySelectorAll(".mediego_content").forEach((function(e){e.style.display="none"}))},DisplayAPI.prototype.showMediegoContent=function(e,t){var n=t.substring("client_".length);document.querySelectorAll(".mediego_content").forEach((function(t){var o=t.querySelectorAll(".mediego"),i=!1,r=!1;o.forEach((function(t){i=i||t.classList.contains("mediego.id."+e),r=r||t.classList.contains("mediego.source."+n)})),i&&r&&(t.style.display="")}))},DisplayAPI.prototype.parseMediegoNodes=function(){var e=this,t=document.querySelectorAll(".mediego"),n=[];return t.forEach((function(t){n.push(e.parseMediegoNode(t))})),n},DisplayAPI.prototype.parseMediegoNode=function(e){var t={node:e,isOptional:!1,isBoolean:!1};return e.classList.forEach((function(e){if(0===e.indexOf("mediego.id"))t.engine=e.split(".")[2];else if(0===e.indexOf("mediego.source"))t.source="client_"+e.split(".")[2];else if(0===e.indexOf("mediego.item")){var n=e.split("."),o=n[1].charAt(n[1].length-1);t.recoIndex=DisplayAPI.alphabet.indexOf(o),t.metadata=n.slice(2,n.length).join(".")}else 0===e.indexOf("mediego.optional")?t.isOptional=!0:0===e.indexOf("mediego.boolean")&&(t.isBoolean=!0)})),t},DisplayAPI.prototype.containsRequest=function(e,t,n){for(var o=0,i=e;o<i.length;o++){var r=i[o];if(r.engine===t&&r.source===n)return!0}return!1},DisplayAPI.alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ",DisplayAPI}();exports.DisplayAPI=DisplayAPI},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AgentUtils=void 0;var o=function(){function e(){}return e.getCookie=function(e){var t=("; "+document.cookie).split("; "+e+"=");return 2==t.length?t.pop().split(";").shift():null},e}();t.AgentUtils=o}]);